(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{388:function(a,t,e){"use strict";e.r(t);var s=e(7),v=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[a._v("[TOC]")]),a._v(" "),t("h1",{attrs:{id:"_1-jps"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-jps"}},[a._v("#")]),a._v(" 1 jps")]),a._v(" "),t("p",[a._v("JVM Process Status Toolï¼Œæ˜¾ç¤ºç³»ç»Ÿå†…æ‰€æœ‰çš„HotSpotè™šæ‹Ÿæœºè¿›ç¨‹ã€‚")]),a._v(" "),t("h2",{attrs:{id:"_1-1-å‘½ä»¤æ ¼å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-å‘½ä»¤æ ¼å¼"}},[a._v("#")]),a._v(" 1.1 å‘½ä»¤æ ¼å¼")]),a._v(" "),t("p",[t("code",[a._v("jps [option] [hostid]")])]),a._v(" "),t("p",[t("strong",[a._v("option")]),a._v("å‚æ•°")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("-l")]),a._v("ï¼šè¾“å‡ºä¸»ç±»å…¨åæˆ–jarè·¯å¾„ ã€‚")]),a._v(" "),t("li",[t("code",[a._v("-q")]),a._v("ï¼šåªè¾“å‡ºLVMID ã€‚")]),a._v(" "),t("li",[t("code",[a._v("-m")]),a._v("ï¼šè¾“å‡ºJVMå¯åŠ¨æ—¶ä¼ é€’ç»™main()çš„å‚æ•° ã€‚")]),a._v(" "),t("li",[t("code",[a._v("-v")]),a._v("ï¼šè¾“å‡ºJVMå¯åŠ¨æ—¶æ˜¾å¼æŒ‡å®šçš„JVMå‚æ•°ã€‚")])]),a._v(" "),t("p",[a._v("å…¶ä¸­[option]ã€[hostid]å‚æ•°ä¹Ÿå¯ä»¥ä¸å†™ã€‚")]),a._v(" "),t("h2",{attrs:{id:"_1-2-ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-ç¤ºä¾‹"}},[a._v("#")]),a._v(" 1.2 ç¤ºä¾‹")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jps -l -m \n22786 org.apache.zookeeper.server.quorum.QuorumPeerMain /opt/zk/bin/../conf/zoo.cfg \n1718 com.aliyun.tianji.cloudmonitor.Application \n18664 /home/bookishBlogApp/vertx-bookish-1.0-fat.jar \n22971 sun.tools.jps.Jps -l -m\n")])])]),t("h1",{attrs:{id:"_2-jstat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-jstat"}},[a._v("#")]),a._v(" 2 Jstat")]),a._v(" "),t("p",[a._v("jstat(JVM statistics Monitoring)æ˜¯ç”¨äºç›‘è§†è™šæ‹Ÿæœºè¿è¡Œæ—¶çŠ¶æ€ä¿¡æ¯çš„å‘½ä»¤ï¼Œå®ƒå¯ä»¥æ˜¾ç¤ºå‡ºè™šæ‹Ÿæœºè¿›ç¨‹ä¸­çš„ç±»è£…è½½ã€å†…å­˜ã€åƒåœ¾æ”¶é›†ã€JITç¼–è¯‘ç­‰è¿è¡Œæ•°æ®ã€‚")]),a._v(" "),t("h2",{attrs:{id:"_2-1-å‘½ä»¤æ ¼å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-å‘½ä»¤æ ¼å¼"}},[a._v("#")]),a._v(" 2.1 å‘½ä»¤æ ¼å¼")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("jstat [option] LVMID [interval] [count]\n")])])]),t("p",[t("strong",[a._v("å‚æ•°")])]),a._v(" "),t("ul",[t("li",[t("code",[a._v("[option]")]),a._v("ï¼šæ“ä½œå‚æ•°ã€‚")]),a._v(" "),t("li",[t("code",[a._v("LVMID")]),a._v("ï¼šæœ¬åœ°è™šæ‹Ÿæœºè¿›ç¨‹IDã€‚")]),a._v(" "),t("li",[t("code",[a._v("[interval]")]),a._v("ï¼šè¿ç»­è¾“å‡ºçš„æ—¶é—´é—´éš”ã€‚")]),a._v(" "),t("li",[t("code",[a._v("[count]")]),a._v("ï¼šè¿ç»­è¾“å‡ºçš„æ¬¡æ•°ã€‚")])]),a._v(" "),t("p",[t("strong",[a._v("option å‚æ•°æ€»è§ˆ")])]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[a._v("å‚æ•°å€¼")]),a._v(" "),t("th",{staticStyle:{"text-align":"center"}},[a._v("è¯´æ˜")])])]),a._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("class")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("ç±»åŠ è½½çš„è¡Œä¸ºç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("compiler")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("JITç¼–è¯‘å™¨çš„è¡Œä¸ºç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gc")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("åƒåœ¾å›æ”¶ä¸­å †çš„è¡Œä¸ºç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gccapacity")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("å„ä¸ªåƒåœ¾å›æ”¶ä»£ï¼ˆæ–°ç”Ÿä»£ã€è€å¹´ä»£ã€æ°¸ä¹…ä»£/å…ƒæ•°æ®åŒºï¼‰å’Œå®ƒä»¬ç›¸åº”çš„ç©ºé—´ç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gcutil")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("åƒåœ¾å›æ”¶ç»Ÿè®¡æ¦‚è¿°")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gccause")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("åƒåœ¾æ”¶é›†ç»Ÿè®¡æ¦‚è¿°ï¼ˆåŒ-gcutilï¼‰ï¼Œé™„åŠ æœ€è¿‘ä¸¤æ¬¡åƒåœ¾å›æ”¶äº‹ä»¶çš„åŸå› ")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gcnew")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("æ–°ç”Ÿä»£è¡Œä¸ºç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gcnewcapacity")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("æ–°ç”Ÿä»£ä¸å…¶ç›¸åº”çš„å†…å­˜ç©ºé—´çš„ç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gcold")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("è€å¹´ä»£å’Œæ°¸ä¹…ä»£è¡Œä¸ºç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gcoldcapacity")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("è€å¹´ä»£ä¸å…¶ç›¸åº”çš„å†…å­˜ç©ºé—´çš„ç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gcpermcapacity")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("æ°¸ä¹…ä»£ä¸å…¶ç›¸åº”çš„å†…å­˜ç©ºé—´çš„ç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("gcmetacapacity")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("å…ƒæ•°æ®åŒºä¸å…¶ç›¸åº”çš„å†…å­˜ç©ºé—´çš„ç»Ÿè®¡")])]),a._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[a._v("printcompilation")]),a._v(" "),t("td",{staticStyle:{"text-align":"center"}},[a._v("HotSpotç¼–è¯‘æ–¹æ³•ç»Ÿè®¡")])])])]),a._v(" "),t("h2",{attrs:{id:"_2-2-ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-ç¤ºä¾‹"}},[a._v("#")]),a._v(" 2.2 ç¤ºä¾‹")]),a._v(" "),t("h3",{attrs:{id:"_2-2-1-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-class"}},[a._v("#")]),a._v(" 2.2.1 -class")]),a._v(" "),t("p",[a._v("ç›‘è§†ç±»è£…è½½ã€å¸è½½æ•°é‡ã€æ€»ç©ºé—´ä»¥åŠè€—è´¹çš„æ—¶é—´ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -class 18664 \nLoaded Bytes  Unloaded Bytes Time \n5065   9756.9 0        0.0   2.96\n")])])]),t("ul",[t("li",[t("code",[a._v("Loaded")]),a._v(" : åŠ è½½classçš„æ•°é‡")]),a._v(" "),t("li",[t("code",[a._v("Bytes")]),a._v(" :åŠ è½½ classå­—èŠ‚å¤§å°")]),a._v(" "),t("li",[t("code",[a._v("Unloaded")]),a._v(" : æœªåŠ è½½classçš„æ•°é‡")]),a._v(" "),t("li",[t("code",[a._v("Bytes")]),a._v(" : æœªåŠ è½½classçš„å­—èŠ‚å¤§å°")]),a._v(" "),t("li",[t("code",[a._v("Time")]),a._v(" : åŠ è½½æ—¶é—´")])]),a._v(" "),t("h3",{attrs:{id:"_2-2-2-compiler"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-compiler"}},[a._v("#")]),a._v(" 2.2.2 -compiler")]),a._v(" "),t("p",[a._v("è¾“å‡ºJITç¼–è¯‘è¿‡çš„æ–¹æ³•ã€æ•°é‡ã€è€—æ—¶ç­‰ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$jstat -compiler 18664 \nCompiled Failed Invalid Time FailedType FailedMethod \n5914     0      0       9.56 0\n")])])]),t("ul",[t("li",[t("code",[a._v("Compiled")]),a._v(" : ç¼–è¯‘æ•°é‡")]),a._v(" "),t("li",[t("code",[a._v("Failed")]),a._v(" : ç¼–è¯‘å¤±è´¥æ•°é‡")]),a._v(" "),t("li",[t("code",[a._v("Invalid")]),a._v(" : æ— æ•ˆæ•°é‡")]),a._v(" "),t("li",[t("code",[a._v("Time")]),a._v(" : ç¼–è¯‘è€—æ—¶")]),a._v(" "),t("li",[t("code",[a._v("FailedType")]),a._v(" : å¤±è´¥ç±»å‹")]),a._v(" "),t("li",[t("code",[a._v("FailedMethod")]),a._v(" : å¤±è´¥æ–¹æ³•çš„å…¨é™å®šå")])]),a._v(" "),t("h3",{attrs:{id:"_2-2-3-gc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-gc"}},[a._v("#")]),a._v(" 2.2.3 -gc")]),a._v(" "),t("p",[a._v("åƒåœ¾å›æ”¶å †çš„è¡Œä¸ºç»Ÿè®¡ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gc 18664 \nS0C   S1C   S0U   S1U EC     EU     OC      OU      MC      MU      CCSC   CCSU   YGC YGCT  FGC FGCT GCT \n704.0 704.0 173.4 0.0 5824.0 4523.7 14332.0 13111.4 32128.0 31190.5 3712.0 3524.6 200 0.451 6 0.151 0.601\n")])])]),t("p",[a._v("Cå³Capacity æ€»å®¹é‡ï¼ŒUå³Used å·²ä½¿ç”¨çš„å®¹é‡")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("S0C")]),a._v(" : survivor0åŒºçš„æ€»å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("S1C")]),a._v(" : survivor1åŒºçš„æ€»å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("S0U")]),a._v(" : survivor0åŒºå·²ä½¿ç”¨çš„å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("S1C")]),a._v(" : survivor1åŒºå·²ä½¿ç”¨çš„å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("EC")]),a._v(" : EdenåŒºçš„æ€»å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("EU")]),a._v(" : EdenåŒºå·²ä½¿ç”¨çš„å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("OC")]),a._v(" : OldåŒºçš„æ€»å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("OU")]),a._v(" : OldåŒºå·²ä½¿ç”¨çš„å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("PC")]),a._v(" å½“å‰æ°¸ä¹…ä»£çš„å®¹é‡ (KB)")]),a._v(" "),t("li",[t("code",[a._v("PU")]),a._v(" æ°¸ä¹…ä»£å·²ä½¿ç”¨çš„å®¹é‡ (KB)")]),a._v(" "),t("li",[t("code",[a._v("MC")]),a._v(" å½“å‰å…ƒæ•°æ®åŒºçš„å®¹é‡ (KB)")]),a._v(" "),t("li",[t("code",[a._v("MU")]),a._v(" å…ƒæ•°æ®åŒºå·²ä½¿ç”¨çš„å®¹é‡ (KB)")]),a._v(" "),t("li",[t("code",[a._v("YGC")]),a._v(" : æ–°ç”Ÿä»£åƒåœ¾å›æ”¶æ¬¡æ•°")]),a._v(" "),t("li",[t("code",[a._v("YGCT")]),a._v(" : æ–°ç”Ÿä»£åƒåœ¾å›æ”¶æ—¶é—´")]),a._v(" "),t("li",[t("code",[a._v("FGC")]),a._v(" : è€å¹´ä»£åƒåœ¾å›æ”¶æ¬¡æ•°")]),a._v(" "),t("li",[t("code",[a._v("FGCT")]),a._v(" : è€å¹´ä»£åƒåœ¾å›æ”¶æ—¶é—´")]),a._v(" "),t("li",[t("code",[a._v("GCT")]),a._v(" : åƒåœ¾å›æ”¶æ€»æ¶ˆè€—æ—¶é—´")])]),a._v(" "),t("h3",{attrs:{id:"_2-2-4-gccapacity"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-gccapacity"}},[a._v("#")]),a._v(" 2.2.4 -gccapacity")]),a._v(" "),t("p",[a._v("åŒ-gcï¼Œä¸è¿‡è¿˜ä¼šè¾“å‡ºJavaå †å„åŒºåŸŸä½¿ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gccapacity 18664 \nNGCMN   NGCMX    NGC    S0C   S1C   EC     OGCMN   OGCMX    OGC     OC      MCMN MCMX      MC      CCSMN CCSMX     CCSC   YGC FGC \n5440.0  85312.0  7232.0 704.0 704.0 5824.0 10944.0 170688.0 14332.0 14332.0 0.0  1077248.0 32128.0 0.0   1048576.0 3712.0 200 6\n")])])]),t("ul",[t("li",[t("code",[a._v("NGCMN")]),a._v(": æ–°ç”Ÿä»£å ç”¨çš„æœ€å°ç©ºé—´")]),a._v(" "),t("li",[t("code",[a._v("NGCMX")]),a._v(" : æ–°ç”Ÿä»£å ç”¨çš„æœ€å¤§ç©ºé—´")]),a._v(" "),t("li",[t("code",[a._v("NGC")]),a._v(" : å½“å‰æ–°ç”Ÿä»£çš„å®¹é‡")]),a._v(" "),t("li",[t("code",[a._v("OGCMN")]),a._v(" : è€å¹´ä»£å ç”¨çš„æœ€å°ç©ºé—´")]),a._v(" "),t("li",[t("code",[a._v("OGCMX")]),a._v(" : è€å¹´ä»£å ç”¨çš„æœ€å¤§ç©ºé—´")]),a._v(" "),t("li",[t("code",[a._v("OGC")]),a._v("ï¼šå½“å‰å¹´è€ä»£çš„å®¹é‡ (KB)")]),a._v(" "),t("li",[t("code",[a._v("OC")]),a._v("ï¼šå½“å‰å¹´è€ä»£çš„ç©ºé—´ (KB)")]),a._v(" "),t("li",[t("code",[a._v("PGCMN")]),a._v(" : æ°¸ä¹…ä»£å ç”¨çš„æœ€å°ç©ºé—´")]),a._v(" "),t("li",[t("code",[a._v("PGCMX")]),a._v(" : æ°¸ä¹…ä»£å ç”¨çš„æœ€å¤§ç©ºé—´")]),a._v(" "),t("li",[t("code",[a._v("MCMN")]),a._v(" : å…ƒæ•°æ®åŒºå ç”¨çš„æœ€å°ç©ºé—´")]),a._v(" "),t("li",[t("code",[a._v("MCMX")]),a._v(" : å…ƒæ•°æ®åŒºå ç”¨çš„æœ€å¤§ç©ºé—´")])]),a._v(" "),t("h3",{attrs:{id:"_2-2-5-gcutil"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-5-gcutil"}},[a._v("#")]),a._v(" 2.2.5 -gcutil")]),a._v(" "),t("p",[a._v("åŒ-gcï¼Œä¸è¿‡è¾“å‡ºçš„æ˜¯å·²ä½¿ç”¨ç©ºé—´å æ€»ç©ºé—´çš„ç™¾åˆ†æ¯”ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gcutil 18664 \nS0     S1    E      O      M      CCS    YGC  YGCT   FGC  FGCT   GCT \n24.63  0.00  85.44  91.48  97.08  94.95  200  0.451  6    0.151  0.601\n")])])]),t("h3",{attrs:{id:"_2-2-6-gccause"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-6-gccause"}},[a._v("#")]),a._v(" 2.2.6 -gccause")]),a._v(" "),t("p",[a._v("åƒåœ¾æ”¶é›†ç»Ÿè®¡æ¦‚è¿°ï¼ˆåŒ-gcutilï¼‰ï¼Œé™„åŠ æœ€è¿‘ä¸¤æ¬¡åƒåœ¾å›æ”¶äº‹ä»¶çš„åŸå› ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gccause 18664 \nS0     S1    E      O      M      CCS    YGC  YGCT   FGC  FGCT   GCT    LGCC                GCC \n24.63  0.00  86.71  91.48  97.08  94.95  200  0.451  6    0.151  0.601  Allocation Failure  No GC\n")])])]),t("ul",[t("li",[t("code",[a._v("LGCC")]),a._v("ï¼šæœ€è¿‘åƒåœ¾å›æ”¶çš„åŸå› ")]),a._v(" "),t("li",[t("code",[a._v("GCC")]),a._v("ï¼šå½“å‰åƒåœ¾å›æ”¶çš„åŸå› ")])]),a._v(" "),t("h3",{attrs:{id:"_2-2-7-gcnew"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-gcnew"}},[a._v("#")]),a._v(" 2.2.7 -gcnew")]),a._v(" "),t("p",[a._v("ç»Ÿè®¡æ–°ç”Ÿä»£çš„è¡Œä¸ºã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gcnew 18664 \nS0C    S1C    S0U    S1U  TT  MTT  DSS    EC      EU      YGC  YGCT \n704.0  704.0  173.4  0.0  15  15   352.0  5824.0  5225.8  200  0.451\n")])])]),t("ul",[t("li",[t("code",[a._v("TT")]),a._v("ï¼šTenuring threshold(æå‡é˜ˆå€¼)")]),a._v(" "),t("li",[t("code",[a._v("MTT")]),a._v("ï¼šæœ€å¤§çš„tenuring threshold")]),a._v(" "),t("li",[t("code",[a._v("DSS")]),a._v("ï¼šsurvivoråŒºåŸŸå¤§å° (KB)")])]),a._v(" "),t("h3",{attrs:{id:"_2-2-8-gcnewcapacity"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-8-gcnewcapacity"}},[a._v("#")]),a._v(" 2.2.8 -gcnewcapacity")]),a._v(" "),t("p",[a._v("æ–°ç”Ÿä»£ä¸å…¶ç›¸åº”çš„å†…å­˜ç©ºé—´çš„ç»Ÿè®¡ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gcnewcapacity 18664 \nNGCMN   NGCMX    NGC     S0CMX   S0C    S1CMX   S1C    ECMX     EC      YGC  FGC \n5440.0  85312.0  7232.0  8512.0  704.0  8512.0  704.0  68288.0  5824.0  200  6\n")])])]),t("ul",[t("li",[t("code",[a._v("NGC")]),a._v(":å½“å‰å¹´è½»ä»£çš„å®¹é‡ (KB)")]),a._v(" "),t("li",[t("code",[a._v("S0CMX")]),a._v(":æœ€å¤§çš„S0ç©ºé—´ (KB)")]),a._v(" "),t("li",[t("code",[a._v("S0C")]),a._v(":å½“å‰S0ç©ºé—´ (KB)")]),a._v(" "),t("li",[t("code",[a._v("ECMX")]),a._v(":æœ€å¤§edenç©ºé—´ (KB)")]),a._v(" "),t("li",[t("code",[a._v("EC")]),a._v(":å½“å‰edenç©ºé—´ (KB)")])]),a._v(" "),t("h3",{attrs:{id:"_2-2-9-gcold"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-9-gcold"}},[a._v("#")]),a._v(" 2.2.9 -gcold")]),a._v(" "),t("p",[a._v("ç»Ÿè®¡è€å¹´ä»£çš„è¡Œä¸ºã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gcold 18664 \nMC      MU      CCSC   CCSU   OC      OU      YGC  FGC  FGCT   GCT \n32128.0 31190.5 3712.0 3524.6 14332.0 13111.4 200  6    0.151  0.601\n")])])]),t("h3",{attrs:{id:"_2-2-10-gcoldcapacity"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-10-gcoldcapacity"}},[a._v("#")]),a._v(" 2.2.10 -gcoldcapacity")]),a._v(" "),t("p",[a._v("ç»Ÿè®¡è€å¹´ä»£çš„å¤§å°å’Œç©ºé—´ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gcoldcapacity 18664 \nOGCMN   OGCMX    OGC     OC      YGC FGC FGCT  GCT \n10944.0 170688.0 14332.0 14332.0 200 6   0.151 0.601\n")])])]),t("h3",{attrs:{id:"_2-2-11-gcpermcapacity"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-11-gcpermcapacity"}},[a._v("#")]),a._v(" 2.2.11 -gcpermcapacity")]),a._v(" "),t("p",[a._v("æ°¸ä¹…ä»£è¡Œä¸ºç»Ÿè®¡ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gcpermcapacity 28920 \n PGCMN      PGCMX       PGC         PC            YGC   FGC    FGCT     GCT   \n 1048576.0  2097152.0   1048576.0   1048576.0     4     0      0.000    0.242\n")])])]),t("h3",{attrs:{id:"_2-2-12-gcmetacapacity"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-12-gcmetacapacity"}},[a._v("#")]),a._v(" 2.2.12 -gcmetacapacity")]),a._v(" "),t("p",[a._v("å…ƒæ•°æ®åŒºè¡Œä¸ºç»Ÿè®¡ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -gcmetacapacity 18664 \nMCMN MCMX      MC      CCSMN CCSMX     CCSC   YGC FGC FGCT   GCT \n0.0  1077248.0 32128.0 0.0   1048576.0 3712.0 200 6   0.151  0.601\n")])])]),t("h3",{attrs:{id:"_2-2-13-printcompilation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-13-printcompilation"}},[a._v("#")]),a._v(" 2.2.13 -printcompilation")]),a._v(" "),t("p",[a._v("hotspotç¼–è¯‘æ–¹æ³•ç»Ÿè®¡ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jstat -printcompilation 18664 \nCompiled Size Type Method \n5914     16   1    com/mongodb/connection/RequestMessage$EncodingMetadata <init>\n")])])]),t("ul",[t("li",[t("code",[a._v("Compiled")]),a._v("ï¼šè¢«æ‰§è¡Œçš„ç¼–è¯‘ä»»åŠ¡çš„æ•°é‡")]),a._v(" "),t("li",[t("code",[a._v("Size")]),a._v("ï¼šæ–¹æ³•å­—èŠ‚ç çš„å­—èŠ‚æ•°")]),a._v(" "),t("li",[t("code",[a._v("Type")]),a._v("ï¼šç¼–è¯‘ç±»å‹")]),a._v(" "),t("li",[t("code",[a._v("Method")]),a._v("ï¼šç¼–è¯‘æ–¹æ³•çš„ç±»åå’Œæ–¹æ³•åã€‚ç±»åä½¿ç”¨â€/â€ ä»£æ›¿ â€œ.â€ ä½œä¸ºç©ºé—´åˆ†éš”ç¬¦ã€‚æ–¹æ³•åæ˜¯ç»™å‡ºç±»çš„æ–¹æ³•åï¼Œæ ¼å¼æ˜¯ä¸€è‡´äºHotSpot â€“ XX:+PrintComplation é€‰é¡¹ã€‚")])]),a._v(" "),t("h1",{attrs:{id:"_3-jmap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-jmap"}},[a._v("#")]),a._v(" 3 jmap")]),a._v(" "),t("p",[a._v("jmap(JVM Memory Map)å‘½ä»¤ç”¨äºç”Ÿæˆheap dumpæ–‡ä»¶ï¼Œå¦‚æœä¸ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œè¿˜å¯ä»¥ä½¿ç”¨"),t("code",[a._v("-XX:+HeapDumpOnOutOfMemoryError")]),a._v("å‚æ•°æ¥è®©è™šæ‹Ÿæœºå‡ºç°OOMçš„æ—¶å€™è‡ªåŠ¨ç”Ÿæˆdumpæ–‡ä»¶ã€‚ jmapä¸ä»…èƒ½ç”Ÿæˆdumpæ–‡ä»¶ï¼Œè¿˜å¯ä»¥æŸ¥è¯¢finalizeæ‰§è¡Œé˜Ÿåˆ—ã€Javaå †å’Œæ°¸ä¹…ä»£çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚å½“å‰ä½¿ç”¨ç‡ã€å½“å‰ä½¿ç”¨çš„æ˜¯å“ªç§æ”¶é›†å™¨ç­‰ã€‚")]),a._v(" "),t("h2",{attrs:{id:"_3-1-å‘½ä»¤æ ¼å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-å‘½ä»¤æ ¼å¼"}},[a._v("#")]),a._v(" 3.1 å‘½ä»¤æ ¼å¼")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("jmap [option] LVMID\n")])])]),t("p",[t("strong",[a._v("optionå‚æ•°")])]),a._v(" "),t("ul",[t("li",[t("code",[a._v("dump")]),a._v(" : ç”Ÿæˆå †è½¬å‚¨å¿«ç…§")]),a._v(" "),t("li",[t("code",[a._v("finalizerinfo")]),a._v(" : æ˜¾ç¤ºåœ¨F-Queueé˜Ÿåˆ—ç­‰å¾…Finalizerçº¿ç¨‹æ‰§è¡Œfinalizeræ–¹æ³•çš„å¯¹è±¡")]),a._v(" "),t("li",[t("code",[a._v("heap")]),a._v(" : æ˜¾ç¤ºJavaå †è¯¦ç»†ä¿¡æ¯")]),a._v(" "),t("li",[t("code",[a._v("histo")]),a._v(" : æ˜¾ç¤ºå †ä¸­å¯¹è±¡çš„ç»Ÿè®¡ä¿¡æ¯")]),a._v(" "),t("li",[t("code",[a._v("permstat")]),a._v(" : to print permanent generation statistics")]),a._v(" "),t("li",[t("code",[a._v("F")]),a._v(" : å½“-dumpæ²¡æœ‰å“åº”æ—¶ï¼Œå¼ºåˆ¶ç”Ÿæˆdumpå¿«ç…§")])]),a._v(" "),t("h2",{attrs:{id:"_3-2-ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-ç¤ºä¾‹"}},[a._v("#")]),a._v(" 3.2 ç¤ºä¾‹")]),a._v(" "),t("h3",{attrs:{id:"_3-2-1-dump"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-dump"}},[a._v("#")]),a._v(" 3.2.1 -dump")]),a._v(" "),t("p",[a._v("å¸¸ç”¨æ ¼å¼"),t("code",[a._v("-dump::live,format=b,file= pid")]),a._v("\ndumpå †åˆ°æ–‡ä»¶ï¼ŒformatæŒ‡å®šè¾“å‡ºæ ¼å¼ï¼ŒliveæŒ‡æ˜æ˜¯æ´»ç€çš„å¯¹è±¡ï¼ŒfileæŒ‡å®šæ–‡ä»¶å")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jmap -dump:live,format=b,file=dump.hprof 28920 \nDumping heap to /home/xxx/dump.hprof ... \nHeap dump file created \ndump.hprofè¿™ä¸ªåç¼€æ˜¯ä¸ºäº†åç»­å¯ä»¥ç›´æ¥ç”¨MAT(Memory Anlysis Tool)æ‰“å¼€\n")])])]),t("p",[a._v("ğŸ’¡ å¯ä»¥ä½¿ç”¨ "),t("strong",[t("a",{attrs:{href:"http://www.eclipse.org/mat/downloads.php",target:"_blank"}},[a._v("Eclipse Memory Analyzer")])]),a._v(" å·¥å…·åˆ†æå †è½¬å‚¨æ–‡ä»¶ï¼Œéå¸¸éå¸¸éå¸¸å¥½ç”¨ï¼")]),a._v(" "),t("h3",{attrs:{id:"_3-2-2-finalizerinfo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-finalizerinfo"}},[a._v("#")]),a._v(" 3.2.2 -finalizerinfo")]),a._v(" "),t("p",[a._v("æ‰“å°ç­‰å¾…å›æ”¶å¯¹è±¡çš„ä¿¡æ¯ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jmap -finalizerinfo 18664 \nAttaching to process ID 18664, please wait... \nDebugger attached successfully. \nServer compiler detected. \nJVM version is 25.144-b01 \nNumber of objects pending for finalization: 0\n")])])]),t("p",[a._v("å¯ä»¥çœ‹åˆ°å½“å‰F-QUEUEé˜Ÿåˆ—ä¸­å¹¶æ²¡æœ‰ç­‰å¾…Finalizerçº¿ç¨‹æ‰§è¡Œfinalizeræ–¹æ³•çš„å¯¹è±¡")]),a._v(" "),t("h3",{attrs:{id:"_3-2-3-heap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-heap"}},[a._v("#")]),a._v(" 3.2.3 -heap")]),a._v(" "),t("p",[a._v("æ‰“å°heapçš„æ¦‚è¦ä¿¡æ¯ã€GCä½¿ç”¨çš„ç®—æ³•ã€heapçš„é…ç½®åŠwise heapçš„ä½¿ç”¨æƒ…å†µã€‚å¯ä»¥ç”¨æ­¤æ¥åˆ¤æ–­å†…å­˜ç›®å‰çš„ä½¿ç”¨æƒ…å†µä»¥åŠåƒåœ¾å›æ”¶æƒ…å†µã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jmap -heap 18664 \nAttaching to process ID 18664, please wait... \nDebugger attached successfully. \nServer compiler detected. \nJVM version is 25.144-b01 \n\nusing thread-local object allocation. \nMark Sweep Compact GC\t                //æ ‡è®°å‹ç¼©GCç®—æ³• \n\nHeap Configuration: \nMinHeapFreeRatio = 40\t                //å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:MinHeapFreeRatioè®¾ç½®JVMå †æœ€å°ç©ºé—²æ¯”ç‡(default 40) \nMaxHeapFreeRatio = 70\t                //å¯¹åº”jvmå¯åŠ¨å‚æ•° -XX:MaxHeapFreeRatioè®¾ç½®JVMå †æœ€å¤§ç©ºé—²æ¯”ç‡(default 70) \nMaxHeapSize = 262144000 (250.0MB)\t//å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:MaxHeapSize=è®¾ç½®JVMå †çš„æœ€å¤§å¤§å° \nNewSize = 5570560 (5.3125MB)\t        //å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:NewSize=è®¾ç½®JVMå †çš„â€˜æ–°ç”Ÿä»£â€™çš„é»˜è®¤å¤§å° \nMaxNewSize = 87359488 (83.3125MB)\t//å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:MaxNewSize=è®¾ç½®JVMå †çš„â€˜æ–°ç”Ÿä»£â€™çš„æœ€å¤§å¤§å° \nOldSize = 11206656 (10.6875MB)\t        //å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:OldSize=<value>:è®¾ç½®JVMå †çš„â€˜è€å¹´ä»£â€™çš„å¤§å° \nNewRatio = 2\t                        //å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:NewRatio=:â€˜æ–°ç”Ÿä»£â€™å’Œâ€˜è€å¹´ä»£â€™çš„å¤§å°æ¯”ç‡ \nSurvivorRatio = 8\t                //å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:SurvivorRatio=è®¾ç½®å¹´è½»ä»£ä¸­EdenåŒºä¸SurvivoråŒºçš„å¤§å°æ¯”å€¼ \nMetaspaceSize = 21807104 (20.796875MB)\t//å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:MetaspaceSize=<value>:è®¾ç½®JVMå †çš„â€˜å…ƒæ•°æ®åŒºâ€™çš„åˆå§‹å¤§å° \nCompressedClassSpaceSize = 1073741824 (1024.0MB)\t\nMaxMetaspaceSize = 17592186044415 MB\t//å¯¹åº”jvmå¯åŠ¨å‚æ•°-XX:MetaspaceSize=<value>:è®¾ç½®JVMå †çš„â€˜å…ƒæ•°æ®åŒºâ€™çš„æœ€å¤§å¤§å° \nG1HeapRegionSize = 0 (0.0MB)\t        //G1åƒåœ¾æ”¶é›†å™¨æ¯ä¸ªRegionåŒºçš„å¤§å° \n\nHeap Usage: \nNew Generation (Eden + 1 Survivor Space): \ncapacity = 6815744 (6.5MB) \nused = 279696 (0.2667388916015625MB) \nfree = 6536048 (6.2332611083984375MB) \n4.103675255408654% used \nEden Space: \ncapacity = 6094848 (5.8125MB) \nused = 279696 (0.2667388916015625MB) \nfree = 5815152 (5.5457611083984375MB) \n4.589056199596774% used \nFrom Space: \ncapacity = 720896 (0.6875MB) \nused = 0 (0.0MB) \nfree = 720896 (0.6875MB) \n0.0% used \nTo Space: \ncapacity = 720896 (0.6875MB) \nused = 0 (0.0MB) \nfree = 720896 (0.6875MB) \n0.0% used \ntenured generation: \ncapacity = 14675968 (13.99609375MB) \nused = 6804304 (6.4890899658203125MB) \nfree = 7871664 (7.5070037841796875MB) \n46.36357887943065% used \n\n8522 interned Strings occupying 779072 bytes.\n")])])]),t("p",[a._v("å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°Javaå †ä¸­å„ä¸ªåŒºåŸŸç›®å‰çš„æƒ…å†µã€‚")]),a._v(" "),t("h3",{attrs:{id:"_3-2-4-histo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-histo"}},[a._v("#")]),a._v(" 3.2.4 -histo")]),a._v(" "),t("p",[a._v("æ‰“å°å †çš„å¯¹è±¡ç»Ÿè®¡ï¼ŒåŒ…æ‹¬å¯¹è±¡æ•°ã€å†…å­˜å¤§å°ç­‰ç­‰ ï¼ˆå› ä¸ºåœ¨dump:liveå‰ä¼šè¿›è¡Œfull gcï¼Œå¦‚æœå¸¦ä¸Šliveåˆ™åªç»Ÿè®¡æ´»å¯¹è±¡ï¼Œå› æ­¤ä¸åŠ liveçš„å †å¤§å°è¦å¤§äºåŠ liveå †çš„å¤§å° ï¼‰")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jmap -histo:live 18664 | more \n\nnum #instances #bytes class name \n---------------------------------------------- \n1: 19123 1458752 [C \n2: 1639 746888 [B \n3: 5430 604224 java.lang.Class \n4: 19017 456408 java.lang.String \n5: 4056 385696 [Ljava.lang.Object; \n6: 8636 276352 java.util.concurrent.ConcurrentHashMap$Node \n7: 2749 145248 [I \n8: 3436 137440 java.util.LinkedHashMap$Entry \n9: 1256 110528 java.lang.reflect.Method \n10: 29 106976 [Ljava.nio.ByteBuffer; \n11: 3274 104768 java.util.HashMap$Node \n12: 6471 103536 java.lang.Object \n13: 814 90656 [Ljava.util.HashMap$Node; \n14: 81 89984 [Ljava.util.concurrent.ConcurrentHashMap$Node; \n15: 78 51168 io.netty.util.internal.shaded.org.jctools.queues.Mps\n")])])]),t("p",[a._v("class nameæ˜¯å¯¹è±¡ç±»å‹ï¼Œè¯´æ˜å¦‚ä¸‹ï¼š")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("B")]),a._v(" ï¼šbyte")]),a._v(" "),t("li",[t("code",[a._v("C")]),a._v(" ï¼šchar")]),a._v(" "),t("li",[t("code",[a._v("D")]),a._v(" ï¼šdouble")]),a._v(" "),t("li",[t("code",[a._v("F")]),a._v(" ï¼šfloat")]),a._v(" "),t("li",[t("code",[a._v("I")]),a._v(" ï¼šint")]),a._v(" "),t("li",[t("code",[a._v("J")]),a._v(" ï¼šlong")]),a._v(" "),t("li",[t("code",[a._v("Z")]),a._v(" ï¼šboolean")]),a._v(" "),t("li",[t("code",[a._v("[")]),a._v(" ï¼šæ•°ç»„ï¼Œå¦‚[Iè¡¨ç¤ºint[]")]),a._v(" "),t("li",[t("code",[a._v("[L+ç±»å")]),a._v(" ï¼šå…¶ä»–å¯¹è±¡")])]),a._v(" "),t("h3",{attrs:{id:"_3-2-5-permstat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-5-permstat"}},[a._v("#")]),a._v(" 3.2.5 -permstat")]),a._v(" "),t("p",[a._v("æ‰“å°Javaå †å†…å­˜çš„æ°¸ä¹…ä¿å­˜åŒºåŸŸçš„ç±»åŠ è½½å™¨çš„æ™ºèƒ½ç»Ÿè®¡ä¿¡æ¯ã€‚")]),a._v(" "),t("p",[a._v("å¯¹äºæ¯ä¸ªç±»åŠ è½½å™¨è€Œè¨€ï¼Œå®ƒçš„åç§°ã€æ´»è·ƒåº¦ã€åœ°å€ã€çˆ¶ç±»åŠ è½½å™¨ã€å®ƒæ‰€åŠ è½½çš„ç±»çš„æ•°é‡å’Œå¤§å°éƒ½ä¼šè¢«æ‰“å°ã€‚æ­¤å¤–ï¼ŒåŒ…å«çš„å­—ç¬¦ä¸²æ•°é‡å’Œå¤§å°ä¹Ÿä¼šè¢«æ‰“å°ã€‚")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jmap -permstat 28920 \n  Attaching to process ID 28920, please wait... \n  Debugger attached successfully. \n  Server compiler detected. \n  JVM version is 24.71-b01 \n  finding class loader instances ..done. \n  computing per loader stat ..done. \n  please wait.. computing liveness.liveness analysis may be inaccurate ... \n  \n  class_loader            classes bytes   parent_loader           alive?  type  \n  <bootstrap>             3111    18154296          null          live    <internal> \n  0x0000000600905cf8      1       1888    0x0000000600087f08      dead    sun/reflect/DelegatingClassLoader@0x00000007800500a0 \n  0x00000006008fcb48      1       1888    0x0000000600087f08      dead    sun/reflect/DelegatingClassLoader@0x00000007800500a0 \n  0x00000006016db798      0       0       0x00000006008d3fc0      dead    java/util/ResourceBundle$RBClassLoader@0x0000000780626ec0 \n  0x00000006008d6810      1       3056      null          dead    sun/reflect/DelegatingClassLoader@0x00000007800500a0\n")])])]),t("h3",{attrs:{id:"_3-2-6-f"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-6-f"}},[a._v("#")]),a._v(" 3.2.6 -F")]),a._v(" "),t("p",[a._v("å¼ºåˆ¶æ¨¡å¼ã€‚")]),a._v(" "),t("p",[a._v("å¦‚æœæŒ‡å®šçš„pidæ²¡æœ‰å“åº”ï¼Œè¯·ä½¿ç”¨jmap -dumpæˆ–jmap -histoé€‰é¡¹ã€‚æ­¤æ¨¡å¼ä¸‹ï¼Œä¸æ”¯æŒliveå­é€‰é¡¹ã€‚")]),a._v(" "),t("h1",{attrs:{id:"_4-jhat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-jhat"}},[a._v("#")]),a._v(" 4 jhat")]),a._v(" "),t("p",[a._v("jhat(JVM Heap Analysis Tool)å‘½ä»¤æ˜¯ä¸jmapæ­é…ä½¿ç”¨ï¼Œç”¨æ¥åˆ†æjmapç”Ÿæˆçš„dumpï¼Œjhatå†…ç½®äº†ä¸€ä¸ªå¾®å‹çš„HTTP/HTMLæœåŠ¡å™¨ï¼Œç”Ÿæˆdumpçš„åˆ†æç»“æœåï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€‚")]),a._v(" "),t("p",[a._v("åœ¨æ­¤è¦æ³¨æ„ï¼Œä¸€èˆ¬ä¸ä¼šç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œåˆ†æï¼Œå› ä¸ºjhatæ˜¯ä¸€ä¸ªè€—æ—¶å¹¶ä¸”è€—è´¹ç¡¬ä»¶èµ„æºçš„è¿‡ç¨‹ï¼Œä¸€èˆ¬æŠŠæœåŠ¡å™¨ç”Ÿæˆçš„dumpæ–‡ä»¶å¤åˆ¶åˆ°æœ¬åœ°æˆ–å…¶ä»–æœºå™¨ä¸Šè¿›è¡Œåˆ†æã€‚")]),a._v(" "),t("h2",{attrs:{id:"_4-1-å‘½ä»¤æ ¼å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-å‘½ä»¤æ ¼å¼"}},[a._v("#")]),a._v(" 4.1 å‘½ä»¤æ ¼å¼")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("jhat [dumpfile]\n")])])]),t("p",[t("strong",[a._v("å‚æ•°")])]),a._v(" "),t("ul",[t("li",[t("code",[a._v("-stack")]),a._v(" ï¼šfalse|true ï¼Œå…³é—­å¯¹è±¡åˆ†é…è°ƒç”¨æ ˆè·Ÿè¸ª(tracking object allocation call stack)ã€‚ å¦‚æœåˆ†é…ä½ç½®ä¿¡æ¯åœ¨å †è½¬å‚¨ä¸­ä¸å¯ç”¨ï¼Œåˆ™å¿…é¡»å°†æ­¤æ ‡å¿—è®¾ç½®ä¸º falseï¼Œé»˜è®¤å€¼ä¸º trueã€‚")]),a._v(" "),t("li",[t("code",[a._v("-refs")]),a._v("ï¼š false|true ï¼Œå…³é—­å¯¹è±¡å¼•ç”¨è·Ÿè¸ª(tracking of references to objects)ã€‚é»˜è®¤å€¼ä¸º trueï¼Œé»˜è®¤æƒ…å†µä¸‹, è¿”å›çš„æŒ‡é’ˆæ˜¯æŒ‡å‘å…¶ä»–ç‰¹å®šå¯¹è±¡çš„å¯¹è±¡ï¼Œå¦‚åå‘é“¾æ¥æˆ–è¾“å…¥å¼•ç”¨(referrers or incoming references)ï¼Œä¼šç»Ÿè®¡è®¡ç®—å †ä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚")]),a._v(" "),t("li",[t("code",[a._v("-port")]),a._v(" ï¼šport-numberï¼Œè®¾ç½® jhat HTTP server çš„ç«¯å£å·ã€‚é»˜è®¤å€¼ 7000ã€‚")]),a._v(" "),t("li",[t("code",[a._v("-exclude")]),a._v(" ï¼šexclude-fileï¼ŒæŒ‡å®šå¯¹è±¡æŸ¥è¯¢æ—¶éœ€è¦æ’é™¤çš„æ•°æ®æˆå‘˜åˆ—è¡¨æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ–‡ä»¶åˆ—åˆ—å‡ºjava.lang.String.value , é‚£ä¹ˆå½“ä»æŸä¸ªç‰¹å®šå¯¹è±¡ Object o è®¡ç®—å¯è¾¾çš„å¯¹è±¡åˆ—è¡¨æ—¶, å¼•ç”¨è·¯å¾„æ¶‰åŠ java.lang.String.value çš„éƒ½ä¼šè¢«æ’é™¤ã€‚")]),a._v(" "),t("li",[t("code",[a._v("-baseline")]),a._v(" ï¼šexclude-fileï¼ŒæŒ‡å®šä¸€ä¸ªåŸºå‡†å †è½¬å‚¨(baseline heap dump)ã€‚åœ¨ä¸¤ä¸ª heap dumps ä¸­æœ‰ç›¸åŒ object ID çš„å¯¹è±¡ä¼šè¢«æ ‡è®°ä¸ºä¸æ˜¯æ–°çš„(marked as not being new)ï¼Œå…¶ä»–å¯¹è±¡è¢«æ ‡è®°ä¸ºæ–°çš„(new)ï¼Œåœ¨æ¯”è¾ƒä¸¤ä¸ªä¸åŒçš„å †è½¬å‚¨æ—¶å¾ˆæœ‰ç”¨ã€‚")]),a._v(" "),t("li",[t("code",[a._v("-debug")]),a._v(" ï¼šintï¼Œè®¾ç½® debug çº§åˆ«. 0 è¡¨ç¤ºä¸è¾“å‡ºè°ƒè¯•ä¿¡æ¯ã€‚ å€¼è¶Šå¤§åˆ™è¡¨ç¤ºè¾“å‡ºæ›´è¯¦ç»†çš„ debug ä¿¡æ¯ã€‚")]),a._v(" "),t("li",[t("code",[a._v("-version")]),a._v(" ï¼šå¯åŠ¨ååªæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å°±é€€å‡ºã€‚")]),a._v(" "),t("li",[t("code",[a._v("-J< flag >")]),a._v(" ï¼šå› ä¸º jhat å‘½ä»¤å®é™…ä¸Šä¼šå¯åŠ¨ä¸€ä¸ªJVMæ¥æ‰§è¡Œï¼Œé€šè¿‡ -J å¯ä»¥åœ¨å¯åŠ¨JVMæ—¶ä¼ å…¥ä¸€äº›å¯åŠ¨å‚æ•°ã€‚\nä¾‹å¦‚ï¼š -J-Xmx512m åˆ™æŒ‡å®šè¿è¡Œ jhat çš„Javaè™šæ‹Ÿæœºä½¿ç”¨çš„æœ€å¤§å †å†…å­˜ä¸º 512 MBï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å¤šä¸ªJVMå¯åŠ¨å‚æ•°ï¼Œåˆ™ä¼ å…¥å¤šä¸ª -Jxxxxxxã€‚")])]),a._v(" "),t("h2",{attrs:{id:"_4-2-ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-ç¤ºä¾‹"}},[a._v("#")]),a._v(" 4.2 ç¤ºä¾‹")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jhat -J-Xmx512m dump.hprof \nReading from dump.hprof... \nDump file created Fri Feb 23 13:40:54 CST 2018 \nSnapshot read, resolving... \nResolving 110430 objects... \nChasing references, expect 22 dots...................... \nEliminating duplicate references...................... \nSnapshot resolved. \nStarted HTTP server on port 7000 \nServer is ready.\n")])])]),t("p",[a._v("ä¸­é—´çš„"),t("code",[a._v("-J-Xmx512m")]),a._v("æ˜¯åœ¨dumpå¿«ç…§å¾ˆå¤§çš„æƒ…å†µä¸‹åˆ†é…512Må†…å­˜å»å¯åŠ¨HTTPæœåŠ¡å™¨ï¼Œè¿è¡Œå®Œä¹‹åå°±å¯åœ¨æµè§ˆå™¨æ‰“å¼€Http://localhost:7000è¿›è¡Œå¿«ç…§åˆ†æï¼Œå †å¿«ç…§åˆ†æä¸»è¦åœ¨æœ€åé¢çš„Heap Histogramé‡Œï¼Œé‡Œé¢æ ¹æ®classåˆ—å‡ºäº†dumpçš„æ—¶å€™æ‰€æœ‰å­˜æ´»å¯¹è±¡ã€‚")]),a._v(" "),t("p",[a._v("æ‰“å¼€æµè§ˆå™¨Http://localhost:7000ï¼Œè¯¥é¡µé¢æä¾›äº†å‡ ä¸ªæŸ¥è¯¢åŠŸèƒ½å¯ä¾›ä½¿ç”¨ï¼š")]),a._v(" "),t("p",[t("img",{attrs:{src:"/img/java/jvm/9.1.png",alt:"img"}})]),a._v(" "),t("p",[a._v("ä¸€èˆ¬æŸ¥çœ‹å †å¼‚å¸¸æƒ…å†µä¸»è¦çœ‹è¿™ä¸ªä¸¤ä¸ªéƒ¨åˆ†ï¼š Show instance counts for all classes (excluding platform)ï¼Œå¹³å°å¤–çš„æ‰€æœ‰å¯¹è±¡ä¿¡æ¯ã€‚å¦‚ä¸‹å›¾ï¼š")]),a._v(" "),t("p",[t("img",{attrs:{src:"/img/java/jvm/9.2.png",alt:"img"}})]),a._v(" "),t("p",[a._v("Show heap histogram ä»¥æ ‘çŠ¶å›¾å½¢å¼å±•ç¤ºå †æƒ…å†µã€‚å¦‚ä¸‹å›¾ï¼š")]),a._v(" "),t("p",[t("img",{attrs:{src:"/img/java/jvm/9.3.png",alt:"img"}})]),a._v(" "),t("p",[a._v("å…·ä½“æ’æŸ¥æ—¶éœ€è¦ç»“åˆä»£ç ï¼Œè§‚å¯Ÿæ˜¯å¦å¤§é‡åº”è¯¥è¢«å›æ”¶çš„å¯¹è±¡åœ¨ä¸€ç›´è¢«å¼•ç”¨æˆ–è€…æ˜¯å¦æœ‰å ç”¨å†…å­˜ç‰¹åˆ«å¤§çš„å¯¹è±¡æ— æ³•è¢«å›æ”¶ã€‚\nä¸€èˆ¬æƒ…å†µï¼Œä¼šdownåˆ°å®¢æˆ·ç«¯ç”¨å·¥å…·æ¥åˆ†æã€‚")]),a._v(" "),t("h1",{attrs:{id:"_5-jstack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-jstack"}},[a._v("#")]),a._v(" 5 jstack")]),a._v(" "),t("p",[a._v("jstackç”¨äºç”Ÿæˆjavaè™šæ‹Ÿæœºå½“å‰æ—¶åˆ»çš„çº¿ç¨‹å¿«ç…§ã€‚")]),a._v(" "),t("p",[a._v("çº¿ç¨‹å¿«ç…§æ˜¯å½“å‰javaè™šæ‹Ÿæœºå†…æ¯ä¸€æ¡çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•å †æ ˆçš„é›†åˆï¼Œç”Ÿæˆçº¿ç¨‹å¿«ç…§çš„ä¸»è¦ç›®çš„æ˜¯å®šä½çº¿ç¨‹å‡ºç°é•¿æ—¶é—´åœé¡¿çš„åŸå› ï¼Œå¦‚çº¿ç¨‹é—´æ­»é”ã€æ­»å¾ªç¯ã€è¯·æ±‚å¤–éƒ¨èµ„æºå¯¼è‡´çš„é•¿æ—¶é—´ç­‰å¾…ç­‰ã€‚")]),a._v(" "),t("p",[a._v("çº¿ç¨‹å‡ºç°åœé¡¿çš„æ—¶å€™é€šè¿‡jstackæ¥æŸ¥çœ‹å„ä¸ªçº¿ç¨‹çš„è°ƒç”¨å †æ ˆï¼Œå°±å¯ä»¥çŸ¥é“æ²¡æœ‰å“åº”çš„çº¿ç¨‹åˆ°åº•åœ¨åå°åšä»€ä¹ˆäº‹æƒ…ï¼Œæˆ–è€…ç­‰å¾…ä»€ä¹ˆèµ„æºã€‚ å¦‚æœjavaç¨‹åºå´©æºƒç”Ÿæˆcoreæ–‡ä»¶ï¼Œjstackå·¥å…·å¯ä»¥ç”¨æ¥è·å¾—coreæ–‡ä»¶çš„java stackå’Œnative stackçš„ä¿¡æ¯ï¼Œä»è€Œå¯ä»¥è½»æ¾åœ°çŸ¥é“javaç¨‹åºæ˜¯å¦‚ä½•å´©æºƒå’Œåœ¨ç¨‹åºä½•å¤„å‘ç”Ÿé—®é¢˜ã€‚å¦å¤–ï¼Œjstackå·¥å…·è¿˜å¯ä»¥é™„å±åˆ°æ­£åœ¨è¿è¡Œçš„javaç¨‹åºä¸­ï¼Œçœ‹åˆ°å½“æ—¶è¿è¡Œçš„javaç¨‹åºçš„java stackå’Œnative stackçš„ä¿¡æ¯ï¼Œå¦‚æœç°åœ¨è¿è¡Œçš„javaç¨‹åºå‘ˆç°hungçš„çŠ¶æ€ï¼Œjstackæ˜¯éå¸¸æœ‰ç”¨çš„ã€‚")]),a._v(" "),t("h2",{attrs:{id:"_5-1-å‘½ä»¤æ ¼å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-å‘½ä»¤æ ¼å¼"}},[a._v("#")]),a._v(" 5.1 å‘½ä»¤æ ¼å¼")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("jstack [option] LVMID\n")])])]),t("p",[t("strong",[a._v("optionå‚æ•°")])]),a._v(" "),t("ul",[t("li",[t("code",[a._v("-F")]),a._v(" : å½“æ­£å¸¸è¾“å‡ºè¯·æ±‚ä¸è¢«å“åº”æ—¶ï¼Œå¼ºåˆ¶è¾“å‡ºçº¿ç¨‹å †æ ˆ")]),a._v(" "),t("li",[t("code",[a._v("-l")]),a._v(" : é™¤å †æ ˆå¤–ï¼Œæ˜¾ç¤ºå…³äºé”çš„é™„åŠ ä¿¡æ¯")]),a._v(" "),t("li",[t("code",[a._v("-m")]),a._v(" : å¦‚æœè°ƒç”¨åˆ°æœ¬åœ°æ–¹æ³•çš„è¯ï¼Œå¯ä»¥æ˜¾ç¤ºC/C++çš„å †æ ˆ")])]),a._v(" "),t("h2",{attrs:{id:"_5-2-ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-ç¤ºä¾‹"}},[a._v("#")]),a._v(" 5.2 ç¤ºä¾‹")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('$ jstack -l 18664 \n2018-02-23 14:20:45 \nFull thread dump Java HotSpot(TM) 64-Bit Server VM (25.144-b01 mixed mode): \n\n"Thread-55" #212 daemon prio=5 os_prio=0 tid=0x00007f68e079f800 nid=0x5fab waiting on condition [0x00007f68d93da000] \njava.lang.Thread.State: TIMED_WAITING (parking) \nat sun.misc.Unsafe.park(Native Method) \n- parking to wait for <0x00000000f5bbda88> (a java.util.concurrent.SynchronousQueue$TransferStack) \nat java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) \nat java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) \nat java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) \nat java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) \nat java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) \nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) \nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) \nat java.lang.Thread.run(Thread.java:748) \n\nLocked ownable synchronizers: \n- None \n......\n')])])]),t("p",[a._v("å…³äºjstackè¾“å‡ºçš„åˆ†æï¼Œè·³è½¬è¿™é‡Œï¼šhttp://www.hollischuang.com/archives/110 ï¼Œå†™çš„éå¸¸æ£’ã€‚")]),a._v(" "),t("h1",{attrs:{id:"_6-jinfo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-jinfo"}},[a._v("#")]),a._v(" 6 jinfo")]),a._v(" "),t("p",[a._v("jinfo(JVM Configuration info)è¿™ä¸ªå‘½ä»¤ä½œç”¨æ˜¯å®æ—¶æŸ¥çœ‹å’Œè°ƒæ•´è™šæ‹Ÿæœºè¿è¡Œå‚æ•°ã€‚ ä¹‹å‰çš„jps -vå£ä»¤åªèƒ½æŸ¥çœ‹åˆ°æ˜¾ç¤ºæŒ‡å®šçš„å‚æ•°ï¼Œå¦‚æœæƒ³è¦æŸ¥çœ‹æœªè¢«æ˜¾ç¤ºæŒ‡å®šçš„å‚æ•°çš„å€¼å°±è¦ä½¿ç”¨jinfoå£ä»¤")]),a._v(" "),t("h2",{attrs:{id:"_6-1-å‘½ä»¤æ ¼å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-å‘½ä»¤æ ¼å¼"}},[a._v("#")]),a._v(" 6.1 å‘½ä»¤æ ¼å¼")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("jinfo [option] [args] LVMID\n")])])]),t("p",[t("strong",[a._v("optionå‚æ•°")])]),a._v(" "),t("ul",[t("li",[t("code",[a._v("-flag")]),a._v(" : è¾“å‡ºæŒ‡å®šargså‚æ•°çš„å€¼")]),a._v(" "),t("li",[t("code",[a._v("-flags")]),a._v(" : ä¸éœ€è¦argså‚æ•°ï¼Œè¾“å‡ºæ‰€æœ‰JVMå‚æ•°çš„å€¼")]),a._v(" "),t("li",[t("code",[a._v("-sysprops")]),a._v(" : è¾“å‡ºç³»ç»Ÿå±æ€§ï¼Œç­‰åŒäºSystem.getProperties()")])]),a._v(" "),t("h2",{attrs:{id:"_6-2-ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-ç¤ºä¾‹"}},[a._v("#")]),a._v(" 6.2 ç¤ºä¾‹")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("$ jinfo -flags 18664 \nAttaching to process ID 18664, please wait... \nDebugger attached successfully. \nServer compiler detected. \nJVM version is 25.144-b01 \nNon-default VM flags: -XX:CICompilerCount=2 -XX:InitialHeapSize=16777216 -XX:MaxHeapSize=262144000 -XX:MaxNewSize=87359488 -XX:MinHeapDeltaBytes=196608 -XX:NewSize=5570560 -XX:OldSize=11206656 -XX:+PrintGC -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+UseCompressedClassPointers -XX:+UseCompressedOops \nCommand line: -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -Xloggc:/home/bookishBlogApp/gc.log\n")])])])])}),[],!1,null,null,null);t.default=v.exports}}]);