(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{308:function(s,t,a){"use strict";a.r(t);var e=a(7),l=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_1-下载安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载安装"}},[s._v("#")]),s._v(" 1. 下载安装")]),s._v(" "),t("p",[s._v("PostgreSQL 可以从 Ubuntu 主存储库中获取，但是不一定是最新版本，可以通过如下命令进行查看：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("apt show postgresql\n")])])]),t("p",[s._v("根据所显示的信息，可以自主决定是安装 Ubuntu 提供的版本还是获取 PostgreSQL 的最新发行版，下面会分别介绍这两种方式。")]),s._v(" "),t("ul",[t("li",[s._v("主存储库版本")])]),s._v(" "),t("p",[s._v("执行命令：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo apt update\nsudo apt install postgresql postgresql-contrib\n")])])]),t("ul",[t("li",[s._v("最新发行版")])]),s._v(" "),t("ol",[t("li",[t("p",[s._v("添加GPG 密钥")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\n")])])])]),s._v(" "),t("li",[t("p",[s._v("添加存储库")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo sh -c 'echo \"deb http://apt.postgresql.org/pub/repos/apt/ `lsb_release -cs`-pgdg main\" >> /etc/apt/sources.list.d/pgdg.list'\n")])])])]),s._v(" "),t("li",[t("p",[s._v("安装")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo apt update\nsudo apt install postgresql postgresql-contrib\n")])])])])]),s._v(" "),t("h2",{attrs:{id:"_2-初始化配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-初始化配置"}},[s._v("#")]),s._v(" 2. 初始化配置")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("检查PostgreSQL状态")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("service postgresql status\n")])])])]),s._v(" "),t("li",[t("p",[s._v("切换postgres用户（默认情况下，PostgreSQL 会创建一个拥有所权限的特殊用户 "),t("code",[s._v("postgres")]),s._v("，要使用 PostgreSQL，必须先登录该用户）")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo su postgres\n")])])])]),s._v(" "),t("li",[t("p",[s._v("启动 PostgreSQL Shell")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("psql\n")])])])]),s._v(" "),t("li",[t("p",[s._v("修改用户postgres的密码（此处的postgres表示PostgreSQL中的用户，除此之外，可以修改任何PostgreSQL用户的密码）")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ALTER USER postgres WITH PASSWORD 'my_password';\n")])])])]),s._v(" "),t("li",[t("p",[s._v("测试postgres用户连接")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("psql -U postgres -d postgres\n")])])]),t("p",[s._v("🔔 如果遇到错误："),t("code",[s._v('psql: FATAL: Peer authentication failed for user "postgres"')]),s._v("，那么通过root用户修改配置文件 "),t("code",[s._v("/etc/postgresql/11/main/pg_hba.conf")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("将\nlocal   all             postgres                                peer\n修改为\nlocal   all             postgres                                md5\n")])])])]),s._v(" "),t("li",[t("p",[s._v("重启")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo service postgresql restart\n")])])])])]),s._v(" "),t("h2",{attrs:{id:"_3-设置允许远程访问"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-设置允许远程访问"}},[s._v("#")]),s._v(" 3. 设置允许远程访问")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("修改配置文件 "),t("code",[s._v("/etc/postgresql/版本号/main/postgresql.conf")]),s._v("，编辑或者添加下面一行，使PostgreSQL可以接受来自任意IP的连接请求。")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("listen_addresses = '*'\n")])])])]),s._v(" "),t("li",[t("p",[s._v("修改配置文件 "),t("code",[s._v("/etc/postgresql/版本号/main/pg_hba.conf")]),s._v("，编辑或者添加下面一行，使PostgreSQL可以对任意IP进行密码验证。")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("host all all 0.0.0.0/0 md5\n")])])])]),s._v(" "),t("li",[t("p",[s._v("重启")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo service postgresql restart\n")])])])])])])}),[],!1,null,null,null);t.default=l.exports}}]);