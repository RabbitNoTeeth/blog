(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{316:function(t,e,_){"use strict";_.r(e);var a=_(7),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[e("strong",[t._v("åž‚ç›´åˆ†è¡¨")]),t._v("ï¼šå³æŒ‰è¡Œåˆ†è¡¨ã€‚")]),t._v(" "),e("p",[e("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼š")]),t._v(" "),e("ol",[e("li",[t._v("ç‰©ç†åˆ†æ•£ï¼Œé€»è¾‘ç»Ÿä¸€ã€‚")]),t._v(" "),e("li",[t._v("æŸ¥è¯¢é€Ÿåº¦å¤§å¹…æå‡ã€‚")]),t._v(" "),e("li",[t._v("åˆ é™¤æ•°æ®é€Ÿåº¦æ›´å¿«ã€‚")]),t._v(" "),e("li",[t._v("å¯ä»¥å°†ä½¿ç”¨çŽ‡ä½Žçš„æ•°æ®é€šè¿‡è¡¨ç©ºé—´æŠ€æœ¯è½¬ç§»åˆ°ä½Žæˆæœ¬çš„å­˜å‚¨ä»‹è´¨ä¸Šã€‚")])]),t._v(" "),e("p",[t._v("ä¸‹é¢é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹æ¥å™è¿°åœ¨PostgreSQLä¸­å¦‚ä½•åž‚ç›´åˆ†è¡¨ã€‚")]),t._v(" "),e("blockquote",[e("p",[t._v("å…¬å¸æŸé¡¹ç›®æ•°æ®åº“çŽ°æœ‰ä¸€æ—¥å¿—è¡¨ t_logï¼Œå…¶ä¸­å­˜å‚¨äº†ç¨‹åºè¿è¡Œä¸‰å¹´æ¥çš„æ‰€æœ‰æ—¥å¿—æ•°æ®ï¼Œæ•°æ®é‡éžå¸¸å¤§ï¼Œå¯¼è‡´æŸ¥è¯¢é€Ÿåº¦éžå¸¸æ…¢ã€‚çŽ°åœ¨éœ€è¦å°†è¯¥è¡¨æŒ‰ç…§å¹´ä»½æ‹†æˆä¸‰ä¸ªè¡¨ï¼Œå³ t_log_2019ã€t_log_2020ã€t_log_2021ï¼Œåˆ†è¡¨åŽè™½ç„¶æ•°æ®åˆ†æ•£å­˜å‚¨ï¼Œä½†æ˜¯åœ¨æŸ¥è¯¢æ—¶è¦ä¿æŒé€»è¾‘ç»Ÿä¸€ï¼Œä¹Ÿå°±æ˜¯ä¾ç„¶åªé€šè¿‡ t_log è¡¨è¿›è¡ŒæŸ¥è¯¢ã€‚")])]),t._v(" "),e("h2",{attrs:{id:"_1-åˆ›å»ºä¸»è¡¨"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-åˆ›å»ºä¸»è¡¨"}},[t._v("#")]),t._v(" 1. åˆ›å»ºä¸»è¡¨")]),t._v(" "),e("p",[t._v("åˆ›å»ºä¸»è¡¨ t_log ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("CREATE TABLE tbl_partition\n(\n  id serial8 NOT NULL,\n  error int NULL,\n  content text NULL,\n  created_time timestamp NULL,\n  CONSTRAINT t_log_pkey PRIMARY KEY (id)\n);\n")])])]),e("p",[t._v("ðŸ’¡ Pg11ä»¥åŠæ›´é«˜ç‰ˆæœ¬æ”¯æŒå¯¹é€»è¾‘ä¸»è¡¨åˆ›å»ºç«‹ç´¢å¼•ï¼Œå­è¡¨è‡ªåŠ¨ç»§æ‰¿ã€‚")]),t._v(" "),e("h2",{attrs:{id:"_2-åˆ›å»ºåˆ†è¡¨"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-åˆ›å»ºåˆ†è¡¨"}},[t._v("#")]),t._v(" 2. åˆ›å»ºåˆ†è¡¨")]),t._v(" "),e("p",[t._v("åˆ†è¡¨å¿…é¡»ç»§æ‰¿ä¸»è¡¨ï¼ŒåŒæ—¶ç»™åˆ†è¡¨æ·»åŠ é™åˆ¶ï¼ˆè¿™äº›é™åˆ¶å†³å®šäº†æ¯å¼ åˆ†è¡¨å…è®¸ä¿å­˜çš„æ•°æ®èŒƒå›´ï¼Œæ¯å¼ è¡¨çš„èŒƒå›´ä¸èƒ½é‡å¤ï¼‰ã€‚")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("CREATE TABLE t_log_2019(CHECK (created_time >= '2019-01-01'::date AND created_time < '2020-01-01'::date)) inherits (t_log);\nCREATE TABLE t_log_2020(CHECK (created_time >= '2020-01-01'::date AND created_time < '2021-01-01'::date)) inherits (t_log);\nCREATE TABLE t_log_2021(CHECK (created_time >= '2021-01-01'::date AND created_time < '2022-01-01'::date)) inherits (t_log);\n")])])]),e("h2",{attrs:{id:"_3-ä¸»è¡¨åˆ›å»ºè§¦å‘å™¨"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-ä¸»è¡¨åˆ›å»ºè§¦å‘å™¨"}},[t._v("#")]),t._v(" 3. ä¸»è¡¨åˆ›å»ºè§¦å‘å™¨")]),t._v(" "),e("p",[t._v("trigger ç»“åˆ Function æ¥å®žçŽ°åˆ†åŒºæ’å…¥ï¼šFunction è´Ÿè´£æ ¹æ®æ¡ä»¶é€‰æ‹©æ’å…¥ï¼Œtrigger è´Ÿè´£è‡ªåŠ¨è°ƒç”¨ Functionã€‚")]),t._v(" "),e("p",[e("strong",[t._v("åˆ›å»ºFunctionï¼š")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("CREATE OR REPLACE FUNCTION t_log_partition_trigger()\n  RETURNS TRIGGER AS $$\nBEGIN\n  IF NEW.created_time >= DATE '2019-01-01' AND NEW.created_time < DATE '2020-01-01'\n  THEN\n    INSERT INTO t_log_2019 VALUES (NEW.*);\n  ELSIF NEW.created_time >= DATE '2020-01-01' AND NEW.created_time < DATE '2021-01-01'\n    THEN\n      INSERT INTO t_log_2020 VALUES (NEW.*);\n  ELSIF NEW.created_time >= DATE '2021-01-01' AND NEW.created_time < DATE '2022-01-01'\n    THEN\n      INSERT INTO t_log_2021 VALUES (NEW.*);\n  END IF;\n  RETURN NULL;\nEND;\n$$\nLANGUAGE plpgsql;\n")])])]),e("p",[e("strong",[t._v("å¯¹ä¸»è¡¨åˆ›å»ºè§¦å‘å™¨ï¼š")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("CREATE TRIGGER insert_t_log_partition_trigger\nBEFORE INSERT ON t_log\nFOR EACH ROW EXECUTE PROCEDURE t_log_partition_trigger();\n")])])]),e("p",[t._v("âœ”ï¸ æ‰“å®Œæ”¶å·¥ï¼")])])}),[],!1,null,null,null);e.default=r.exports}}]);